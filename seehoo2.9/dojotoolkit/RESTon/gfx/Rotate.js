define(["dojo/_base/declare","./Axis","dojox/gfx","dojox/gfx/Moveable"],function(t,n,o,a){return t(null,{constructor:function(t,o,a,e){if(e==undefined)e=[t];this.move=t;this.target=e;this.axis=new n(o,a);var i=t.parent;this.container=i._parent;this._init()},_init:function(){var t=this;var n=this.move._getRealMatrix()||{dx:0,dy:0};var o=new a(this.move);o.onMoveStart=function(o,a){var e=dojo.position(t.container);this.startAngle=t.axis.getAngle(o.lastX-n.dx-e.x,o.lastY-n.dy-e.y)-(t.currentAngle||0);t.onRotateStart(this.startAngle)};o.onMove=function(o,a){var e=dojo.position(t.container);var i=t.axis.getAngle(o.lastX+a.dx-n.dx-e.x,o.lastY+a.dy-n.dy-e.y);var r=i-this.startAngle;t.rotateg(r);t.onRotate(r)};o.onMoveStop=function(o){var a=dojo.position(t.container);var e=t.axis.getAngle(o.lastX-n.dx-a.x,o.lastY-n.dy-a.y);var i=e-this.startAngle;t.rotateg(i);t.onRotateStop(i)}},rotateg:function(t){this.currentAngle=t;for(var n in this.target){this.target[n].setTransform([o.matrix.rotategAt(t,this.axis.x,this.axis.y)])}},onRotateStart:function(t){},onRotate:function(t){},onRotateStop:function(t){}})});